# MLG-FluidDynamics

This repo is for our CS224W project â€” using Graph Neural Networks to simulate fluid dynamics based on DeepMindâ€™s â€œLearning to Simulate Complex Physicsâ€ paper. We are hoping to represent more real world events, from simulating oil spills in water, waves generated by falling icebergs to behaviour of water bound plastics.

## Dataset generating

We are using Taichi Elements (https://github.com/taichi-dev/taichi_elements - required for running the code) to generate the datasets. 

The simulation is executed multiple times using varying initial parameters, and the resulting data is stored for model training.

## Model 
### Simple 3-layer MLP
#### Data construction  

- Builds training pairs by concatenating positions at 
tâˆ’2 and 
tâˆ’1.

- Target is the position at time 
t.

- Outputs flattened sample tensors, shuffled and split 90 / 10 into train / valid sets.

#### Model

- Input: concatenated [xtâˆ’2, xtâˆ’1].

- Two hidden layers of 64 units with ReLU.

- Output predicts next position xt.

#### Training

- Optimized with Adam (3e-4) and MSE loss.

- Standard train / eval loop over 5 epochs, reporting average train and validation MSE each epoch.

### GNS
GNS is currently still in progress.

## How to use our project

Open project.ipynb and run the cells.  

> If you want to run smaller datasets, please do this.
Generate data and add it to folder temp/datasets/WaterDropNase. You should have a folder structure like this:  
<img width="258" height="259" alt="image" src="https://github.com/user-attachments/assets/10012efb-4012-4b8e-bf26-50f37e4ccc96" />

ğŸ’¡ If you are time / space limited, you can skip test data for now and just copy the train data and rename it to valid.

